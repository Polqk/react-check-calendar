!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("antd"),require("moment"),require("@ant-design/icons/lib"),require("antd/dist/antd.min.css"),require("react-moment")):"function"==typeof define&&define.amd?define(["exports","react","antd","moment","@ant-design/icons/lib","antd/dist/antd.min.css","react-moment"],t):t((e=e||self).reactCheckCalendar={},e.react,e.antd,e.moment,e.lib,0,e.Moment)}(this,function(e,t,a,n,r,s,i){function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function o(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return l(e,void 0);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?l(e,void 0):void 0}}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i;var d={navBarAvCalendar:"_3cRwb",btnPrevAvCalendar:"_22kIo",btnNextAvCalendar:"_3b8ev",avCalTable:"_3NMd3",biggerCheckbox:"_2f1Tx",avCalHeadLine:"_33oxk",hSpan:"_29wgx",hoverHourRow:"_1vCZ3",timeCol:"_3MpDj",avCalShow:"_L4A8D",avCalHide:"_3IgKM",displayNone:"_6CZ00",display:"_3a60R",prospectMessage:"_1vqN7"},c=t.createContext({locale:"en"}),u=function(e){var a=e.date,n=t.useContext(c);return t.createElement("div",null,t.createElement("div",null,t.createElement(i,{className:"check-calendar__day-number",locale:n.locale,format:"ddd"},a)),t.createElement("div",null,t.createElement(i,{className:"check-calendar_day",locale:"fr",format:"DD"},a)),t.createElement("div",null,t.createElement(i,{className:"check-calendar__month",locale:"fr",format:"MMM"},a)),t.createElement("div",null))},h=function(e){for(var r,s,i,l,o,c=[],u=e.row,h=e.availabilities,f=!1,m=!1,v=e.interval||{start:void 0,end:void 0},p=v.start,b=v.end,g=0;g<e.dates.length;g++){var k=e.dates[g];if(p&&(l=n(k).set("hour",p).set("minute",0).set("second",0).set("millisecond",0)),b&&(o=n(k).set("hour",b).set("minute",0).set("second",0).set("millisecond",0)),s=u+"-"+g+"-"+(r=k.format("Y_M_D")),f=!1,m=!1,(i=!!h&&h.get(r))&&i.checked&&(f=i.checked[u]),k.isBefore(e.disableBefore))m=!0;else if(Array.isArray(e.disabledDates)&&(l||o))for(var C=0;!m&&C<e.disabledDates.length;C++){var w=e.disabledDates[C];l&&"Invalid Date"!=l._d&&l.isBetween(w.start,w.end,null,"[]")&&(m=!0),m||o&&"Invalid Date"!=o._d&&o.isBetween(w.start,w.end,null,"[]")&&(m=!0)}c.push(t.createElement("td",{key:s+"-td"},t.createElement(a.Checkbox,{id:s+"-cb",ref:e.cbRef,disabled:m,checked:!m&&f,onChange:e.handleChange,className:d.biggerCheckbox,value:"off"})))}return t.createElement(t.Fragment,null,c)},f=function(e){var s,i;function l(t){var a;(a=e.call(this,t)||this).handleNextWeek=function(){var e=a.state.firstDate,t=a.state.week;t+=1,e.add(7,"day"),a.setState({loading:!0}),setTimeout(function(){a._initDates(e,t),a.setState({loading:!1})},400)},a.handlePreviousWeek=function(){a.setState({loading:!0}),setTimeout(function(){var e=a.state.firstDate,t=a.state.week,r=n(new Date);t--,e.subtract(7,"day"),e.diff(r)<0&&(t=0,e=r),a._initDates(e,t),a.setState({loading:!1})},400)},a.handleCheckBoxChange=function(e){var t,n=e.target.checked,r=e.target.id.split("-"),s=r[0],i=r[2],o=a.state.hoursIntervals,d=a.state.datesMap,c=d.get(i),u=c.date.clone(),h=c.date.clone();c.availabilities||(c.availabilities=[]),c.checked||(c.checked=[!1,!1,!1,!1]),u.set("minute",0).set("second",0).set("millisecond",0),h.set("minute",0).set("second",0).set("millisecond",0),u.set("hour",o[parseInt(s,10)].start),h.set("hour",o[parseInt(s,10)].end),n?(e.target.checked=!0,c.checked[parseInt(s,10)]=!0,t=l._addAvailabilities(c,u,h)):(e.target.checked=!1,c.checked[parseInt(s,10)]=!1,t=l._removeAvailabilities(c,u,h)),d.set(i,t),a.setState({datesMap:d})},a.handleRowMouseEnter=function(e){var t=a.refs["hoursRow-"+e.target.id];t&&(t.className="hoverHourRow")},a.handleRowMouseLeave=function(e){var t=a.refs["hoursRow-"+e.target.id];if(t)t.className="defaultHourRow";else for(var n=0;n<4;n++)a.refs["hoursRow-"+n].className="defaultHourRow"},a.handleRowClick=function(e){var t,r=e.target.id,s=a.state,i=s.dates,l=s.rowsCheck,d=s.hoursIntervals,c=parseInt(r,10),u=l[a.state.week][c]=!l[a.state.week][c],h={},f=n(),m=f.get("hour");f=f.format("Y_M_D"),h.target={id:""};for(var v,p=0,b=o(i);!(v=b()).done;)t=n(v.value).format("Y_M_D"),h.target.id=r+"-"+p+"-"+t+"-cb",h.target.checked=u,t===f&&m>=d[c].start&&(h.target.checked=!1),a.handleCheckBoxChange(h),p++;a.setState({rowsCheck:l})},a.handleCheckBoxCreate=function(e){e&&a.checkBoxes.set(e.props.id,e)};for(var r=[],s=t.maxWeeks?t.maxWeeks:4,i=0;i<s;i++)r.push([!1,!1,!1,!1]);var d=t.hoursIntervals;return d||(d=[{start:8,end:10},{start:10,end:12,pause:{start:12,end:13}},{start:12,end:15},{start:15,end:17}]),a.checkBoxes=new Map,a.state={rowsCheck:r,firstDate:n(),dates:[],datesMap:new Map,week:0,maxWeeks:t.maxWeeks?t.maxWeeks:4,hoursIntervals:d,loading:!1},a}i=e,(s=l).prototype=Object.create(i.prototype),s.prototype.constructor=s,s.__proto__=i;var c=l.prototype;return c.componentDidMount=function(){this._initDates(this.state.firstDate)},c._initDates=function(e,t){void 0===t&&(t=0);var a,r,s=this.state.datesMap,i=new Array(5);if(i[0]=a=e instanceof n?e:n(e),!s.get(a.format("Y_M_D"))){var l=[];l.date=a,s.set(a.format("Y_M_D"),l)}for(var o=1;o<i.length;o++)i[o]=n(i[o-1]).add(1,"day"),6!==i[o].day()&&0!==i[o].day()||(i[o]=i[o].add(1,"week").set("day",1)),s.get(i[o].format("Y_M_D"))||((r=[]).date=i[o],s.set(i[o].format("Y_M_D"),r));this.setState({dates:i,datesMap:s,currentDate:a,week:t})},l._addAvailabilities=function(e,t,a){var n=e.availabilities,r={start:t,end:a},s=!1;if(0===n.length)s=!0,n.push(r);else for(var i,l=o(n);!(i=l()).done;){var d=i.value;d.start.diff(t,"minutes")>0?0===d.start.diff(a,"minutes")&&(d.start=t,s=!0):d.start.diff(t,"minutes")<0?0===d.end.diff(t,"minutes")&&(d.end=a,s=!0):s=!0}return s||n.push(r),n.length>1&&(n[0].end.isBetween(n[1].start,n[1].end)||n[0].start.isBetween(n[1].start,n[1].end)||n[1].end.isBetween(n[0].start,n[0].end)||n[1].start.isBetween(n[0].start,n[0].end))&&(n[0].start.diff(n[1].start,"minutes")>0&&n[0].start.set("hour",n[1].start.get("hour")),n[0].end.diff(n[1].end,"minutes")<0&&n[0].end.set("hour",n[1].end.get("hour")),n=[n[0]]),e.availabilities=n,e},l._removeAvailabilities=function(e,t,a){var n=e.availabilities;if(0!==n.length){var r,s,i=!1;for(var l in n)0===t.diff((s=n[l]).start,"minutes")?0===a.diff(s.end,"minutes")?i=l:s.start.set("hour",a.get("hour")):0===a.diff(s.end,"minutes")?0===t.diff(s.start,"minutes")?i=l:s.end.set("hour",t.get("hour")):(t.isBetween(s.start,s.end)||a.isBetween(s.start,s.end))&&(r=[{start:s.start.clone(),end:t.clone()},{start:a.clone(),end:s.end.clone()}]);r?e.availabilities=r:!1!==i&&e.availabilities.splice(i,1)}return e},c.getDates=function(){var e=[];return this.state.datesMap.forEach(function(t){if(t.availabilities)for(var a,n=o(t.availabilities);!(a=n()).done;){var r=a.value;e.push({start:r.start.toDate(),end:r.end.toDate()})}}),e},c.getMoments=function(){var e=[];return this.state.datesMap.forEach(function(t){if(t.availabilities)for(var a,n=o(t.availabilities);!(a=n()).done;)e.push(a.value)}),e},c.render=function(){for(var e=this,s=this.state,i=s.dates,l=s.week,o=s.maxWeeks,c=s.datesMap,f=s.hoursIntervals,m=s.loading,v=[],p=[],b=0;b<i.length;b++)v.push(t.createElement("td",{key:"dateCol-"+b,className:d.avCalHeadLine},t.createElement(u,{date:i[b]})));for(var g,k,C=[],w=0;w<f.length;w++)f[w].pause?f[w].pause.start===f[w].start?(g=f[w].pause.end,k=f[w].end):(g=f[w].start,k=f[w].pause.start):(g=f[w].start,k=f[w].end),C.push(t.createElement("div",{id:w.toString()},"de ",t.createElement("span",{id:w.toString(),className:d.hSpan},g,"H")," à ",t.createElement("span",{id:w.toString(),className:d.hSpan},k,"H")));for(var _=0;_<f.length;_++)p.push(t.createElement("tr",{className:d.defaultHourRow,key:"hoursRow-"+_,ref:"hoursRow-"+_},t.createElement("td",{className:d.timeCol,id:_.toString(),onClick:this.handleRowClick,onMouseEnter:this.handleRowMouseEnter,onMouseLeave:this.handleRowMouseLeave},C[_]),t.createElement(h,{hoursIntervals:f,interval:f[_],dates:i,disabledDates:this.props.disabledDates,checkedDates:this.props.checkedDates,disableBefore:this.props.disableBefore||n(),availabilities:c,row:_,handleChange:this.handleCheckBoxChange,cbRef:function(t){e.handleCheckBoxCreate(t)}})));return t.createElement("div",{className:d.prospectCalendar},t.createElement("div",{className:d.navBarAvCalendar},t.createElement(a.Button,{className:d.btnPrevAvCalendar,type:"primary",disabled:0===l,onClick:this.handlePreviousWeek},t.createElement(r.LeftOutlined,null),"Semaine précédente"),t.createElement(a.Button,{className:d.btnNextAvCalendar,type:"primary",disabled:!(l<o-1),onClick:this.handleNextWeek},"Semaine suivante",t.createElement(r.RightOutlined,null))),t.createElement("div",{className:m?d.avCalHide:d.avCalShow,ref:"calendar"},t.createElement("table",{className:d.avCalTable},t.createElement("thead",null),t.createElement("tbody",null,t.createElement("tr",{className:d.avCalHeadLine},t.createElement("td",{className:d.avCalHeadLine}),v),p))))},l}(t.Component);e.CheckCalendar=f,e.default=f});
//# sourceMappingURL=index.umd.js.map
